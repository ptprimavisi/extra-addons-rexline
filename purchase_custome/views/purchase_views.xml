<odoo>
    <data>
        <menuitem id="cost_control_mrf" groups="sale_custome.cost_control" name="Cost Control" sequence="10"/>
        <record id="view_move_form_inherit_purchase" model="ir.ui.view">
        <field name="name">account.move.inherit.purchase</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='ref']" position="after">
                    <field name="count_dp" invisible="1"/>
                </xpath>
            <xpath expr="//div[@name='button_box']" position="inside">
                <button class="oe_stat_button"
                        name="action_view_dp"
                        type="object"
                        icon="fa-pencil-square-o"
                        invisible="count_dp == 0 or move_type not in ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt') or state != 'posted'">
                    <field string="Down Payment Info" name="count_dp" widget="statinfo"/>
                </button>
            </xpath>
        </field>
    </record>
        <record id="mrf_form_view" model="ir.ui.view">
            <field name="name">mrf.mrf.form.view</field>
            <field name="model">mrf.mrf</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <field name="state" widget="statusbar" statusbar_visible="draft,to_inventory,request,confirm,cancel"/>
                        <button name="action_inventory" string="To Inventory" type="object" class="oe_highlight" invisible="id == False or state != 'draft'"/>
                        <button name="request_budget" string="Request Budget" type="object" groups="sale_custome.inventory_custom_group" class="oe_highlight" invisible="state != 'to_inventory'"/>
                        <button name="action_confirm" string="Confirm" class="oe_highlight" groups="sale_custome.cost_control" type="object" invisible="state == 'confirm' or id == False or state != 'request' or state == 'cancel'"/>
                        <button name="action_print" string="Print" type="object" invisible="state == 'draft' or id == False or state == 'cancel'"/>
                        <button name="action_cancel" confirm="Do you want to cancel this proccess?" string="Cancel" type="object" invisible="state == 'draft' or id == False or state == 'cancel'"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="action_count_quotation"
                                    type="object"
                                    class="oe_stat_button"
                                    invisible="count_quotation == 0"
                                    icon="fa-list">
                                    <field name="count_quotation" widget="statinfo" string="Purchase Order"/>
                            </button>
                        </div>
                        <div class="oe_title">
                            <h1>
                                <field name="name" invisible="id == False"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="partner_id" string="Customer" required="1"/>
                                <field name="inquiry_id" readonly="state != 'draft'"/>
                                <field name="request_date"/>
                                <field name="to_inventory" invisible="1"/>
                                <field name="picking_type_id" string="Deliver To" required="1"/>
                                <field name="department_id"/>
                            </group>
                            <group>
                                <field name="due_date" required="1"/>
                                <field name="validity"/>
                                <field name="lead_time"/>
                                <field name="quotation_state" invisible="1"/>
                                <field name="is_accounting" invisible="1"/>
                            </group>


<!--                            <field name="bol" invisible="1"/>-->
<!--                            <button string="Cretae Quotation" name="action_rfq" type="object" class="oe_highlight" invisible="id == False"/>-->
                        </group>
<!--                        <group>-->
<!--                            -->
<!--                        </group>-->
                        <button string="Create Purchase Order" name="action_rfq" groups="sale_custome.purchasing_custom_group" type="object" class="oe_highlight" invisible="id == False or state != 'confirm'"/>
                        <notebook>
<!--                            <button name="action_rfq" string="Cretae Quotations" type="object" class="btn-primary" icon="fa-plus"/>-->
                            <page string="Product Lines">
                                <field name="mrf_line_ids" required="1">
                                    <tree editable="bottom">
                                        <field name="select"/>
                                        <button name="action_count_quotation" string="View Quotation" type="object" class="oe_highlight" invisible="count_quotation == 0"/>
                                        <field name="sale_id" string="SO No."/>
                                        <field name="product_id"/>
                                        <field name="type" string="type / category"/>
                                        <field name="description"/>
                                        <field name="specs_detail" string="Specs detail"/>
                                        <field name="brand" required="1"/>
                                        <field name="count_quotation" invisible="1"/>
                                        <field name="quantity"/>
                                        <field name="qty_onhand" string="On Hand"/>
                                        <field name="avilable_qty"/>
                                        <field name="qty_purchase"/>
                                        <field name="qty_ordered"/>
                                        <field name="qty_received"/>
                                        <field name="product_uom_id"/>
                                        <field name="unit_weight" string="Unit weight/kg" optional="hide"/>
                                        <field name="total_weight" string="Total weight/kg" optional="hide"/>
                                        <field name="qty_budget" readonly="is_accounting != True" optional="hide"/>
                                        <field name="budget" readonly="is_accounting != True" optional="hide"/>
                                        <field name="subtotal_budget" optional="hide"/>
                                        <field name="budget_use" readonly="1" optional="hide"/>
                                        <field name="best_price" invisible_column="is_accounting == True" optional="hide"/>
                                        <field name="year" readonly="is_accounting != True" optional="hide"/>
                                        <field name="unit_cost"/>
                                        <field name="subtotal" readonly="1"/>
                                        <field name="product_uom_category_id" invisible="1" nolabel="1" optional="hide"/>
                                        <field name="schedule_date" optional="hide"/>
                                        <field name="wh_id" string="Dest Location" optional="hide"/>
<!--                                        <field name="vendor_id" string="Vendor" required="1"/>-->
                                        <field name="attachment" widget="binary" filename="attachment_name" optional="hide"/>
                                        <field name="is_accounting" invisible="1" nolabel="1"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Cost Control">
                                <field name="mrf_line_ids" required="1">
                                    <tree editable="bottom" create="false" delete="false">
                                        <field name="product_id"/>
                                        <field name="description"/>
                                        <field name="qty_purchase"/>
                                        <field name="qty_ordered"/>
                                        <field name="qty_received"/>
                                        <field name="qty_budget" readonly="is_accounting != True"/>
                                        <field name="budget" readonly="is_accounting != True"/>
                                        <field name="subtotal_budget"/>
                                        <field name="budget_use" readonly="1"/>
                                        <field name="unit_cost"/>
                                        <field name="subtotal" readonly="1"/>
                                        <field name="is_accounting" invisible="1" nolabel="1"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                        <group col="12" class="oe_invoice_lines_tab">
                            <group colspan="8">
                            <!--<field name="narration" placeholder="Terms and Conditions" class="oe_inline text-break" nolabel="1"/>-->
                            </group>
                            <group colspan="4">
                                <group class="oe_subtotal_footer oe_right" >
                                    <field name="total_cost" widget="monetary" string="Total Cost" readonly="1"/>
                                    <field name="total_budget" widget="monetary" string="Total Budget" readonly="1"/>
                                    <field name="total_budget_use" widget="monetary" string="Total Budget Use" readonly="1"/>
<!--                                <field name="amount_total" invisible="1"/>-->
<!--                                <field name="amount_fix" string="Total Invoice Setelah Potongan" required="1"/>-->
                                </group>
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>

                </form>
            </field>
        </record>

        <record id="mrf_mrf_tree_view" model="ir.ui.view">
            <field name="name">mrf.mrf.tree.view</field>
            <field name="model">mrf.mrf</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
<!--                    <field name="to_inventory"/>-->
                    <field name="partner_id" string="Customer"/>
                    <field name="request_date" string="Date"/>
<!--                    <field name="quotation_state" />-->
                    <field name="quotation_state" string="Quotation Status"
                            decoration-danger="quotation_state == 'no'"
                            decoration-success="quotation_state == 'yes'"
                            widget="badge"
                            optional="show"/>
                    <field name="state" string="Status"
                            decoration-info="state == 'draft'"
                            decoration-success="state == 'confirm'"
                            decoration-muted="state == 'cancel'"
                            widget="badge"
                            optional="show"/>
<!--                    <field name="note"/>-->
                </tree>
            </field>
        </record>
        <record id="purchase_order_tree_view_inherit" model="ir.ui.view">
            <field name="name">purchase.order.inherit.tree</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_kpis_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='origin']" position="after">
                    <field name="mrf_id" string="MRF"/>
                    <field name="sale_id" string="SO No"/>
                </xpath>
            </field>
        </record>
        <record id="purchase_order_trees_view_inherit" model="ir.ui.view">
            <field name="name">purchase.order.inherits.tree</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_view_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='origin']" position="after">
                    <field name="mrf_id" string="MRF"/>
                    <field name="sale_id" string="SO No"/>
                </xpath>
            </field>
        </record>

        <record id="purchase_order_form_view_inherit" model="ir.ui.view">
            <field name="name">purchase.order.inherit.form</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='picking_type_id']" position="after">
                    <field name="source_doc"/>
                    <field name="tag_ids" string="Tags" widget="many2many_tags"/>
                    <field name="mrf_id" string="MRF"/>
                    <field name="sale_id" string="SO No"/>
                </xpath>
                <xpath expr="//field[@name='currency_id']" position="after">
                    <field name="down_payment" string="Down Payment" readonly="1"/>
                    <field name="tp_value" invisible="1"/>
                    <field name="paymen_term_id" readonly="state in ['purchase','done']"/>
                </xpath>
                <xpath expr="//field[@name='order_line']/tree/field[@name='price_unit']" position="after">
                    <field name="budget"/>
                    <field name="best_price"/>
                    <field name="source_po"/>
                </xpath>
            </field>
        </record>


        <record id="mrf_mrf_filtered_view" model="ir.ui.view">
            <field name="name">mrf.mrf.filtered.view</field>
            <field name="model">mrf.mrf</field>
            <field name="arch" type="xml">
                    <search string="Filter views">
                        <!-- Define your filters here -->
                        <filter string="Check by Inventory" name="inventory_check" domain="[('state', '=', 'to_inventory')]"/>
                        <filter string="To Cost Control" name="cost_control" domain="[('state', '=', 'request')]"/>
                        <filter string="Production" name="production" domain="[('department_id', '=', 33)]"/>
                        <field name="name"/>
                        <field name="partner_id"/>

                    </search>
            </field>
        </record>

        <record id="action_mrf_mrf" model="ir.actions.act_window">
            <field name="name">Material Request</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrf.mrf</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_mrf_mrf_inventory" model="ir.actions.act_window">
            <field name="name">Material Request</field>
            <field name="type">ir.actions.act_window</field>
            <field name="context">{"search_default_inventory_check":1}</field>
            <field name="res_model">mrf.mrf</field>
            <field name="view_mode">tree,form</field>
        </record>
        <record id="action_mrf_mrf_production" model="ir.actions.act_window">
            <field name="name">Material Request</field>
            <field name="type">ir.actions.act_window</field>
            <field name="context">{"search_default_production":1}</field>
            <field name="res_model">mrf.mrf</field>
            <field name="view_mode">tree,form</field>
        </record>
        <record id="action_mrf_mrf_account" model="ir.actions.act_window">
            <field name="name">Material Request</field>
            <field name="type">ir.actions.act_window</field>
            <field name="context">{"search_default_cost_control":1}</field>
            <field name="res_model">mrf.mrf</field>
            <field name="view_mode">tree,form</field>
        </record>


        <menuitem id="menu_mrf" name="Material Request" parent="purchase.menu_procurement_management" action="action_mrf_mrf" sequence="100"/>
        <menuitem id="menu_mrf_production" name="Material Request" parent="mrp.menu_mrp_root" action="action_mrf_mrf_production" sequence="11"/>
        <menuitem id="menu_mrf_inventory" name="Material Request" parent="stock.menu_stock_warehouse_mgmt" action="action_mrf_mrf_inventory" sequence="100"/>
        <menuitem id="menu_mrf_account" name="Material Request" parent="cost_control_mrf" action="action_mrf_mrf_account" sequence="6"/>

    </data>
</odoo>